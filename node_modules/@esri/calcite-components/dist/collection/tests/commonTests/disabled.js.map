{"version":3,"file":"disabled.js","sourceRoot":"","sources":["../../../../src/tests/commonTests/disabled.ts"],"names":[],"mappings":"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","sourcesContent":["import { E2EElement, E2EPage, EventSpy } from \"@stencil/core/testing\";\nimport { toHaveNoViolations } from \"jest-axe\";\nimport { IntrinsicElementsWithProp, skipAnimations } from \"./../utils\";\nimport { getTagAndPage } from \"./utils\";\nimport { ComponentTestSetup, DisabledOptions, FocusTarget } from \"./interfaces\";\n\nexpect.extend(toHaveNoViolations);\n\n/**\n * Helper to test the disabled prop disabling user interaction.\n *\n * Note that this helper should be used within a describe block.\n *\n * @example\n * describe(\"disabled\", () => {\n *    disabled(\"calcite-input\")\n * });\n *\n * @param {ComponentTestSetup} componentTestSetup - A component tag, html, or the tag and e2e page for setting up a test.\n * @param {DisabledOptions} [options] - Disabled options.\n */\nexport function disabled(componentTestSetup: ComponentTestSetup, options?: DisabledOptions): void {\n  options = { focusTarget: \"host\", ...options };\n\n  const addRedirectPrevention = async (page: E2EPage, tag: string): Promise<void> => {\n    await page.$eval(tag, (el) => {\n      el.addEventListener(\n        \"click\",\n        (event) => {\n          const path = event.composedPath() as HTMLElement[];\n          const anchor = path.find((el) => el?.tagName === \"A\");\n\n          if (anchor) {\n            // we prevent the default behavior to avoid a page redirect\n            anchor.addEventListener(\"click\", (event) => event.preventDefault(), { once: true });\n          }\n        },\n        true,\n      );\n    });\n  };\n\n  async function expectToBeFocused(page: E2EPage, tag: string): Promise<void> {\n    const focusedTag = await page.evaluate(() => document.activeElement?.tagName.toLowerCase());\n    expect(focusedTag).toBe(tag);\n  }\n\n  function assertOnMouseAndPointerEvents(spies: EventSpy[], expectCallback: (spy: EventSpy) => void): void {\n    for (const spy of spies) {\n      expectCallback(spy);\n    }\n  }\n\n  // only testing events from https://github.com/web-platform-tests/wpt/blob/master/html/semantics/disabled-elements/event-propagate-disabled.tentative.html#L66\n  const eventsExpectedToBubble = [\"mousemove\", \"pointermove\", \"pointerdown\", \"pointerup\"];\n  const eventsExpectedToNotBubble = [\"mousedown\", \"mouseup\", \"click\"];\n  const allExpectedEvents = [...eventsExpectedToBubble, ...eventsExpectedToNotBubble];\n\n  const createEventSpiesForExpectedEvents = async (component: E2EElement): Promise<EventSpy[]> => {\n    const eventSpies: EventSpy[] = [];\n\n    for (const event of allExpectedEvents) {\n      eventSpies.push(await component.spyOnEvent(event));\n    }\n\n    return eventSpies;\n  };\n\n  async function getFocusTarget(page: E2EPage, tag: string, focusTarget: FocusTarget): Promise<string> {\n    return focusTarget === \"host\" ? tag : await page.evaluate(() => document.activeElement?.tagName.toLowerCase());\n  }\n\n  const getTabAndClickFocusTarget = async (\n    page: E2EPage,\n    tag: string,\n    focusTarget: DisabledOptions[\"focusTarget\"],\n  ): Promise<string[]> => {\n    if (typeof focusTarget === \"object\") {\n      return [focusTarget.tab, focusTarget.click];\n    }\n\n    const sameClickAndTabFocusTarget = await getFocusTarget(page, tag, focusTarget);\n\n    return [sameClickAndTabFocusTarget, sameClickAndTabFocusTarget];\n  };\n\n  const getShadowFocusableCenterCoordinates = async (page: E2EPage, tabFocusTarget: string): Promise<number[]> => {\n    return await page.$eval(tabFocusTarget, (element: HTMLElement) => {\n      const focusTarget = element.shadowRoot.activeElement || element;\n      const rect = focusTarget.getBoundingClientRect();\n\n      return [rect.x + rect.width / 2, rect.y + rect.height / 2];\n    });\n  };\n\n  it(\"prevents focusing via keyboard and mouse\", async () => {\n    const { page, tag } = await getTagAndPage(componentTestSetup);\n\n    const component = await page.find(tag);\n    const ariaAttributeTargetElement = options.shadowAriaAttributeTargetSelector\n      ? await page.find(`${tag} >>> ${options.shadowAriaAttributeTargetSelector}`)\n      : component;\n    await skipAnimations(page);\n    await addRedirectPrevention(page, tag);\n\n    const eventSpies = await createEventSpiesForExpectedEvents(component);\n\n    expect(ariaAttributeTargetElement.getAttribute(\"aria-disabled\")).toBeNull();\n\n    if (options.focusTarget === \"none\") {\n      await page.click(tag);\n      await page.waitForChanges();\n      await expectToBeFocused(page, \"body\");\n\n      assertOnMouseAndPointerEvents(eventSpies, (spy) => expect(spy).toHaveReceivedEventTimes(1));\n\n      component.setProperty(\"disabled\", true);\n      await page.waitForChanges();\n\n      expect(ariaAttributeTargetElement.getAttribute(\"aria-disabled\")).toBe(\"true\");\n\n      await page.click(tag);\n      await page.waitForChanges();\n      await expectToBeFocused(page, \"body\");\n\n      await component.callMethod(\"click\");\n      await page.waitForChanges();\n      await expectToBeFocused(page, \"body\");\n\n      assertOnMouseAndPointerEvents(eventSpies, (spy) => {\n        expect(spy).toHaveReceivedEventTimes(eventsExpectedToBubble.includes(spy.eventName) ? 2 : 1);\n      });\n\n      return;\n    }\n\n    await page.keyboard.press(\"Tab\");\n\n    const [tabFocusTarget, clickFocusTarget] = await getTabAndClickFocusTarget(page, tag, options.focusTarget);\n\n    expect(tabFocusTarget).not.toBe(\"body\");\n    await expectToBeFocused(page, tabFocusTarget);\n\n    const [shadowFocusableCenterX, shadowFocusableCenterY] = await getShadowFocusableCenterCoordinates(\n      page,\n      tabFocusTarget,\n    );\n\n    async function resetFocusOrder(): Promise<void> {\n      // test page has default margin, so clicking on 0,0 will not hit the test element\n      await page.mouse.click(0, 0);\n    }\n\n    await resetFocusOrder();\n    await expectToBeFocused(page, \"body\");\n\n    await page.mouse.click(shadowFocusableCenterX, shadowFocusableCenterY);\n    await page.waitForChanges();\n    await expectToBeFocused(page, clickFocusTarget);\n\n    await component.callMethod(\"click\");\n    await page.waitForChanges();\n    await expectToBeFocused(page, clickFocusTarget);\n\n    assertOnMouseAndPointerEvents(eventSpies, (spy) => {\n      if (spy.eventName === \"click\") {\n        // some components emit more than one click event (e.g., from calling `click()`),\n        // so we check if at least one event is received\n        expect(spy.length).toBeGreaterThanOrEqual(2);\n      } else {\n        expect(spy).toHaveReceivedEventTimes(1);\n      }\n    });\n\n    component.setProperty(\"disabled\", true);\n    await page.waitForChanges();\n\n    expect(ariaAttributeTargetElement.getAttribute(\"aria-disabled\")).toBe(\"true\");\n\n    await resetFocusOrder();\n    await page.keyboard.press(\"Tab\");\n    await expectToBeFocused(page, \"body\");\n\n    await page.mouse.click(shadowFocusableCenterX, shadowFocusableCenterY);\n    await expectToBeFocused(page, \"body\");\n\n    assertOnMouseAndPointerEvents(eventSpies, (spy) => {\n      if (spy.eventName === \"click\") {\n        // some components emit more than one click event (e.g., from calling `click()`),\n        // so we check if at least one event is received\n        expect(spy.length).toBeGreaterThanOrEqual(2);\n      } else {\n        expect(spy).toHaveReceivedEventTimes(eventsExpectedToBubble.includes(spy.eventName) ? 2 : 1);\n      }\n    });\n  });\n\n  it(\"events are no longer blocked right after enabling\", async () => {\n    const { page, tag } = await getTagAndPage(componentTestSetup);\n\n    const component = await page.find(tag);\n    const ariaAttributeTargetElement = options.shadowAriaAttributeTargetSelector\n      ? await page.find(`${tag} >>> ${options.shadowAriaAttributeTargetSelector}`)\n      : component;\n\n    await skipAnimations(page);\n    await addRedirectPrevention(page, tag);\n\n    const eventSpies = await createEventSpiesForExpectedEvents(component);\n\n    component.setProperty(\"disabled\", true);\n    await page.waitForChanges();\n\n    expect(ariaAttributeTargetElement.getAttribute(\"aria-disabled\")).toBe(\"true\");\n\n    await page.click(tag);\n    await page.waitForChanges();\n\n    assertOnMouseAndPointerEvents(eventSpies, (spy) => {\n      expect(spy).toHaveReceivedEventTimes(eventsExpectedToBubble.includes(spy.eventName) ? 1 : 0);\n    });\n\n    type InteractiveCalciteComponents = IntrinsicElementsWithProp<\"disabled\"> & HTMLElement;\n\n    // this needs to run in the browser context to ensure disabling and events fire immediately after being set\n    await page.$eval(\n      tag,\n      (component: InteractiveCalciteComponents, allExpectedEvents: string[]) => {\n        component.disabled = false;\n        allExpectedEvents.forEach((event) => component.dispatchEvent(new MouseEvent(event)));\n\n        component.disabled = true;\n        allExpectedEvents.forEach((event) => component.dispatchEvent(new MouseEvent(event)));\n      },\n      allExpectedEvents,\n    );\n\n    assertOnMouseAndPointerEvents(eventSpies, (spy) => {\n      if (spy.eventName === \"click\") {\n        // some components emit more than one click event (e.g., from calling `click()`),\n        // so we check if at least one event is received\n        expect(spy.length).toBeGreaterThanOrEqual(1);\n      } else {\n        expect(spy).toHaveReceivedEventTimes(eventsExpectedToBubble.includes(spy.eventName) ? 3 : 1);\n      }\n    });\n  });\n}\n"]}